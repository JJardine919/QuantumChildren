<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Radar - Bio-Immune Surveillance</title>
    <style>
        body {
            margin: 0;
            background: #050505;
            color: #10b981;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
        }
        #radar-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #radar-canvas {
            border: 1px solid #10b98133;
            border-radius: 50%;
            box-shadow: 0 0 50px #10b98111;
        }
        .stats-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #10b981;
            font-size: 12px;
            z-index: 10;
        }
        .energy-source {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border: 1px solid #ff0000;
            color: #ff0000;
            font-size: 14px;
            z-index: 10;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        .control-label {
            margin-bottom: 5px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="stats-panel">
        <span class="control-label">SYSTEM: QNIF LIVE MONITOR</span>
        <span class="control-label">STATUS: ENTANGLED</span>
        <div id="gen-count">GENERATION: 1</div>
        <div id="active-tes">ACTIVE TEs: 33</div>
        <div id="comp-ratio">COMPRESSION: 2.67</div>
    </div>

    <div class="energy-source" id="top-energy">
        DETECTION: HIGH ENERGY SOURCE
        <div id="energy-val">STRENGTH: 91.2%</div>
        <div id="energy-loc">LOC: SECTOR Q24</div>
    </div>

    <div id="radar-container">
        <canvas id="radar-canvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('radar-canvas');
        const ctx = canvas.getContext('2d');
        const size = Math.min(window.innerWidth, window.innerHeight) * 0.8;
        canvas.width = size;
        canvas.height = size;

        const center = size / 2;
        const radius = size / 2;

        // Mock TE Data
        const tes = Array.from({length: 33}, (_, i) => ({
            id: i,
            angle: (i / 33) * Math.PI * 2,
            distance: radius * 0.4 + Math.random() * radius * 0.5,
            strength: Math.random(),
            energy: Math.random() * 100
        }));

        function drawRadar() {
            ctx.clearRect(0, 0, size, size);

            // Draw circular grid
            ctx.strokeStyle = '#10b98133';
            ctx.lineWidth = 1;
            for (let i = 1; i <= 4; i++) {
                ctx.beginPath();
                ctx.arc(center, center, (radius / 4) * i, 0, Math.PI * 2);
                ctx.stroke();
            }

            // Draw scan line
            const time = Date.now() / 1000;
            const scanAngle = time % (Math.PI * 2);
            ctx.beginPath();
            ctx.moveTo(center, center);
            ctx.lineTo(center + Math.cos(scanAngle) * radius, center + Math.sin(scanAngle) * radius);
            ctx.strokeStyle = '#10b98188';
            ctx.stroke();

            // Draw TEs
            tes.forEach(te => {
                // Animate jumping
                if (Math.random() < 0.01) {
                    te.distance = radius * 0.2 + Math.random() * radius * 0.7;
                    te.angle += (Math.random() - 0.5) * 0.2;
                }

                const x = center + Math.cos(te.angle) * te.distance;
                const y = center + Math.sin(te.angle) * te.distance;

                // Color based on energy
                const color = te.energy > 90 ? '#ff0000' : '#10b981';
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(x, y, te.strength * 5 + 2, 0, Math.PI * 2);
                ctx.fill();

                if (te.energy > 90) {
                    ctx.strokeStyle = '#ff0000';
                    ctx.beginPath();
                    ctx.arc(x, y, 15, 0, Math.PI * 2);
                    ctx.stroke();
                    document.getElementById('energy-val').innerText = `STRENGTH: ${te.energy.toFixed(1)}%`;
                    document.getElementById('energy-loc').innerText = `LOC: SECTOR Q${te.id}`;
                }
            });

            requestAnimationFrame(drawRadar);
        }

        drawRadar();

        // Simulate Live Data Fetch
        setInterval(() => {
            fetch('../qnif_signal_BTCUSD.json')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('comp-ratio').innerText = `COMPRESSION: ${data.compression.ratio.toFixed(2)}`;
                    document.getElementById('active-tes').innerText = `ACTIVE TEs: ${data.teqa.active_tes.length}`;
                    document.getElementById('gen-count').innerText = `GENERATION: ${data.vdj.generation}`;
                })
                .catch(e => {});
        }, 5000);
    </script>
</body>
</html>
